# AidRigs Backend API

FastAPI-based backend for the AidRigs Parts Database System.

## ğŸš€ Quick Start

### Local Development

1. **Install Poetry** (if not already installed):
   ```bash
   curl -sSL https://install.python-poetry.org | python3 -
   ```

2. **Install dependencies:**
   ```bash
   poetry install
   ```

3. **Set up environment:**
   ```bash
   cp .env.example .env
   # Edit .env with your configuration
   ```

4. **Run database migrations:**
   ```bash
   poetry run alembic upgrade head
   ```

5. **Start the server:**
   ```bash
   poetry run uvicorn app.main:app --reload
   ```

6. **Access the API:**
   - API: http://localhost:8000
   - Swagger Docs: http://localhost:8000/docs
   - ReDoc: http://localhost:8000/redoc
   - Health Check: http://localhost:8000/health

## ğŸ“ Project Structure

```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py              # FastAPI application entry point
â”‚   â”œâ”€â”€ api/                 # API routes and endpoints
â”‚   â”‚   â””â”€â”€ routes.py
â”‚   â”œâ”€â”€ core/                # Core functionality
â”‚   â”‚   â”œâ”€â”€ config.py        # Application settings
â”‚   â”‚   â””â”€â”€ database.py      # Database configuration
â”‚   â”œâ”€â”€ models/              # SQLAlchemy models
â”‚   â”œâ”€â”€ schemas/             # Pydantic schemas
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ alembic/                 # Database migrations
â”‚   â”œâ”€â”€ versions/            # Migration files
â”‚   â””â”€â”€ env.py               # Alembic environment
â”œâ”€â”€ pyproject.toml           # Poetry dependencies
â”œâ”€â”€ alembic.ini              # Alembic configuration
â””â”€â”€ Dockerfile
```

## ğŸ—„ï¸ Database Migrations

### Create a new migration:
```bash
poetry run alembic revision --autogenerate -m "description of changes"
```

### Apply migrations:
```bash
poetry run alembic upgrade head
```

### Rollback last migration:
```bash
poetry run alembic downgrade -1
```

### View migration history:
```bash
poetry run alembic history
```

## ğŸ§ª Testing

### Run all tests:
```bash
poetry run pytest
```

### Run with coverage:
```bash
poetry run pytest --cov=app
```

## ğŸ”§ Code Quality

### Format code with Black:
```bash
poetry run black app/
```

### Lint with Ruff:
```bash
poetry run ruff check app/
```

### Type check with mypy:
```bash
poetry run mypy app/
```

## ğŸ³ Docker

### Build image:
```bash
docker build -t aidrigs-backend .
```

### Run container:
```bash
docker run -p 8000:8000 --env-file .env aidrigs-backend
```

## ğŸ“š API Documentation

The API documentation is automatically generated by FastAPI:

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

## ğŸ” Environment Variables

See `.env.example` for all available configuration options.

Key variables:
- `DATABASE_URL`: PostgreSQL connection string
- `SECRET_KEY`: JWT secret key (change in production!)
- `API_HOST`: API host (default: 0.0.0.0)
- `API_PORT`: API port (default: 8000)

## ğŸ› ï¸ Development

### Adding a new endpoint:

1. Create route in `app/api/routes.py`
2. Create Pydantic schema in `app/schemas/`
3. Create SQLAlchemy model in `app/models/`
4. Run migrations: `poetry run alembic revision --autogenerate -m "add new model"`
5. Apply migrations: `poetry run alembic upgrade head`

### Adding dependencies:

```bash
poetry add package-name
```

### Adding dev dependencies:

```bash
poetry add --group dev package-name
```

## ğŸ“ License

[Add your license here]
